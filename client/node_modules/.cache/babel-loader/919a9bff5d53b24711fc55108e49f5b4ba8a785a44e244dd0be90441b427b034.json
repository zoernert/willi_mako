{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useParams}from'react-router-dom';import ReactMarkdown from'react-markdown';import{Box,Paper,TextField,Button,Typography,List,ListItem,Avatar,Divider,IconButton,CircularProgress,Alert,Tooltip}from'@mui/material';import{Send as SendIcon,Person as PersonIcon,SmartToy as BotIcon,Add as AddIcon}from'@mui/icons-material';import{useSnackbar}from'../contexts/SnackbarContext';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Chat=()=>{const{chatId}=useParams();const{showSnackbar}=useSnackbar();const[chats,setChats]=useState([]);const[currentChat,setCurrentChat]=useState(null);const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[loading,setLoading]=useState(false);const[chatLoading,setChatLoading]=useState(true);const[error,setError]=useState(null);const[isTyping,setIsTyping]=useState(false);const messagesEndRef=useRef(null);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{fetchChats();},[]);useEffect(()=>{if(chatId){fetchChat(chatId);}},[chatId]);useEffect(()=>{scrollToBottom();},[messages]);const fetchChats=async()=>{try{console.log('Fetching chats...');const response=await axios.get('/chat/chats');console.log('Chats fetched:',response.data.data);setChats(response.data.data);}catch(error){console.error('Error fetching chats:',error);setError('Fehler beim Laden der Chats');}};const fetchChat=async id=>{try{console.log('Fetching chat:',id);setChatLoading(true);// Reset loading state for message sending when switching chats\nsetLoading(false);setIsTyping(false);const response=await axios.get(`/chat/chats/${id}`);console.log('Chat fetched:',response.data.data);setCurrentChat(response.data.data.chat);setMessages(response.data.data.messages||[]);setError(null);}catch(error){console.error('Error fetching chat:',error);setError('Fehler beim Laden des Chats');}finally{console.log('Setting chatLoading to false');setChatLoading(false);}};const createNewChat=async()=>{try{console.log('Creating new chat...');const response=await axios.post('/chat/chats',{title:'Neuer Chat'});console.log('New chat created:',response.data.data);const newChat=response.data.data;setChats([newChat,...chats]);setCurrentChat(newChat);setMessages([]);// Reset loading states when creating new chat\nsetLoading(false);setIsTyping(false);window.history.pushState({},'',`/chat/${newChat.id}`);}catch(error){console.error('Error creating new chat:',error);showSnackbar('Fehler beim Erstellen des Chats','error');}};const sendMessage=async e=>{e.preventDefault();if(!newMessage.trim()||!currentChat||loading){return;}const messageContent=newMessage.trim();setNewMessage('');setLoading(true);setIsTyping(true);console.log('Sending message:',messageContent);// Timeout-Promise für 30 Sekunden\nconst timeoutPromise=new Promise((_,reject)=>{setTimeout(()=>reject(new Error('Request timeout')),30000);});try{const response=await Promise.race([axios.post(`/chat/chats/${currentChat.id}/messages`,{content:messageContent}),timeoutPromise]);console.log('API Response:',response);// Validate response structure\nif(!response.data||!response.data.data){throw new Error('Invalid response format: missing data');}const{userMessage,assistantMessage,updatedChatTitle}=response.data.data;// Validate required fields\nif(!userMessage||!assistantMessage){throw new Error('Invalid response format: missing userMessage or assistantMessage');}console.log('User message:',userMessage);console.log('Assistant message:',assistantMessage);setMessages(prev=>[...prev,userMessage,assistantMessage]);// Update chat in the list and current chat if title was updated\nif(updatedChatTitle){console.log('Updating chat title:',updatedChatTitle);const updatedChat={...currentChat,title:updatedChatTitle,updated_at:new Date().toISOString()};setCurrentChat(updatedChat);setChats(prev=>prev.map(chat=>chat.id===currentChat.id?updatedChat:chat));}else{// Update chat timestamp\nsetChats(prev=>prev.map(chat=>chat.id===currentChat.id?{...chat,updated_at:new Date().toISOString()}:chat));}console.log('Message sent successfully');}catch(error){console.error('Error sending message:',error);// Restore the message input if there was an error\nsetNewMessage(messageContent);if((error===null||error===void 0?void 0:error.message)==='Request timeout'){showSnackbar('Anfrage ist abgelaufen. Bitte versuchen Sie es erneut.','error');}else{showSnackbar('Fehler beim Senden der Nachricht','error');}}finally{console.log('Setting loading to false');setLoading(false);setIsTyping(false);}};const formatTime=dateString=>{return new Date(dateString).toLocaleTimeString('de-DE',{hour:'2-digit',minute:'2-digit'});};return/*#__PURE__*/_jsxs(Box,{sx:{height:'calc(100vh - 100px)',display:'flex',gap:2},children:[/*#__PURE__*/_jsxs(Paper,{sx:{width:300,p:2,overflowY:'auto'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',justifyContent:'space-between',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Chats\"}),/*#__PURE__*/_jsx(IconButton,{onClick:createNewChat,color:\"primary\",children:/*#__PURE__*/_jsx(AddIcon,{})})]}),/*#__PURE__*/_jsx(Divider,{sx:{mb:2}}),/*#__PURE__*/_jsx(List,{children:chats.map(chat=>/*#__PURE__*/_jsx(ListItem,{sx:{cursor:'pointer',borderRadius:1,mb:1,backgroundColor:(currentChat===null||currentChat===void 0?void 0:currentChat.id)===chat.id?'primary.light':'transparent','&:hover':{backgroundColor:'action.hover'}},onClick:()=>{setCurrentChat(chat);// Reset loading states when switching chats\nsetLoading(false);setIsTyping(false);fetchChat(chat.id);window.history.pushState({},'',`/chat/${chat.id}`);},children:/*#__PURE__*/_jsxs(Box,{sx:{width:'100%',overflow:'hidden'},children:[/*#__PURE__*/_jsx(Tooltip,{title:chat.title,arrow:true,children:/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",sx:{overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap',width:'100%',display:'block'},children:chat.title})}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",children:formatTime(chat.updated_at)})]})},chat.id))})]}),/*#__PURE__*/_jsxs(Paper,{sx:{flex:1,display:'flex',flexDirection:'column'},children:[error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{m:2},children:error}),!currentChat?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',alignItems:'center',justifyContent:'center',flex:1},children:/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(BotIcon,{sx:{fontSize:80,color:'text.secondary',mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"W\\xE4hlen Sie einen Chat oder starten Sie ein neues Gespr\\xE4ch mit Mako Willi\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:createNewChat,sx:{mt:2},startIcon:/*#__PURE__*/_jsx(AddIcon,{}),children:\"Neuen Chat mit Mako Willi starten\"})]})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Box,{sx:{p:2,borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:currentChat.title})}),/*#__PURE__*/_jsx(Box,{sx:{flex:1,overflowY:'auto',p:2},children:chatLoading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',mt:4},children:/*#__PURE__*/_jsx(CircularProgress,{})}):/*#__PURE__*/_jsxs(List,{children:[messages.map(message=>/*#__PURE__*/_jsxs(ListItem,{sx:{alignItems:'flex-start',mb:2,flexDirection:message.role==='user'?'row-reverse':'row'},children:[/*#__PURE__*/_jsx(Avatar,{sx:{mx:1,bgcolor:message.role==='user'?'primary.main':'secondary.main'},children:message.role==='user'?/*#__PURE__*/_jsx(PersonIcon,{}):/*#__PURE__*/_jsx(BotIcon,{})}),/*#__PURE__*/_jsxs(Paper,{sx:{p:2,maxWidth:'70%',bgcolor:message.role==='user'?'primary.light':'grey.100',color:message.role==='user'?'white':'text.primary'},children:[message.role==='user'?/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{whiteSpace:'pre-wrap'},children:message.content}):/*#__PURE__*/_jsx(ReactMarkdown,{components:{p:_ref=>{let{children}=_ref;return/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mb:1},children:children});},h1:_ref2=>{let{children}=_ref2;return/*#__PURE__*/_jsx(Typography,{variant:\"h4\",sx:{mb:1,fontWeight:'bold'},children:children});},h2:_ref3=>{let{children}=_ref3;return/*#__PURE__*/_jsx(Typography,{variant:\"h5\",sx:{mb:1,fontWeight:'bold'},children:children});},h3:_ref4=>{let{children}=_ref4;return/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{mb:1,fontWeight:'bold'},children:children});},ul:_ref5=>{let{children}=_ref5;return/*#__PURE__*/_jsx(Box,{component:\"ul\",sx:{mb:1,pl:2},children:children});},ol:_ref6=>{let{children}=_ref6;return/*#__PURE__*/_jsx(Box,{component:\"ol\",sx:{mb:1,pl:2},children:children});},li:_ref7=>{let{children}=_ref7;return/*#__PURE__*/_jsx(Typography,{component:\"li\",variant:\"body1\",sx:{mb:0.5},children:children});},strong:_ref8=>{let{children}=_ref8;return/*#__PURE__*/_jsx(Typography,{component:\"strong\",sx:{fontWeight:'bold'},children:children});},em:_ref9=>{let{children}=_ref9;return/*#__PURE__*/_jsx(Typography,{component:\"em\",sx:{fontStyle:'italic'},children:children});},code:_ref0=>{let{children}=_ref0;return/*#__PURE__*/_jsx(Typography,{component:\"code\",sx:{backgroundColor:'rgba(0,0,0,0.1)',padding:'2px 4px',borderRadius:'4px',fontFamily:'monospace',fontSize:'0.9em'},children:children});},pre:_ref1=>{let{children}=_ref1;return/*#__PURE__*/_jsx(Paper,{sx:{p:1,backgroundColor:'rgba(0,0,0,0.1)',overflow:'auto',mb:1},children:/*#__PURE__*/_jsx(Typography,{component:\"pre\",sx:{fontFamily:'monospace',fontSize:'0.9em',whiteSpace:'pre-wrap',margin:0},children:children})});},blockquote:_ref10=>{let{children}=_ref10;return/*#__PURE__*/_jsx(Paper,{sx:{p:1,borderLeft:'4px solid',borderLeftColor:'primary.main',backgroundColor:'rgba(0,0,0,0.05)',mb:1},children:children});}},children:message.content}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{display:'block',mt:1,opacity:0.7},children:formatTime(message.created_at)})]})]},message.id)),isTyping&&/*#__PURE__*/_jsxs(ListItem,{sx:{alignItems:'flex-start',mb:2,flexDirection:'row'},children:[/*#__PURE__*/_jsx(Avatar,{sx:{mx:1,bgcolor:'secondary.main'},children:/*#__PURE__*/_jsx(BotIcon,{})}),/*#__PURE__*/_jsx(Paper,{sx:{p:2,maxWidth:'70%',bgcolor:'grey.100',color:'text.primary'},children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(CircularProgress,{size:16}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontStyle:'italic'},children:\"Mako Willi tippt...\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})}),/*#__PURE__*/_jsx(Box,{component:\"form\",onSubmit:sendMessage,sx:{p:2,borderTop:1,borderColor:'divider'},children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,maxRows:4,placeholder:\"Fragen Sie Mako Willi etwas \\xFCber die Energiewirtschaft...\",value:newMessage,onChange:e=>setNewMessage(e.target.value),disabled:loading,onKeyPress:e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage(e);}}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",disabled:loading||!newMessage.trim(),sx:{minWidth:'auto',px:2},children:loading?/*#__PURE__*/_jsx(CircularProgress,{size:24}):/*#__PURE__*/_jsx(SendIcon,{})})]})})]})]})]});};export default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","ReactMarkdown","Box","Paper","TextField","Button","Typography","List","ListItem","Avatar","Divider","IconButton","CircularProgress","Alert","Tooltip","Send","SendIcon","Person","PersonIcon","SmartToy","BotIcon","Add","AddIcon","useSnackbar","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Chat","chatId","showSnackbar","chats","setChats","currentChat","setCurrentChat","messages","setMessages","newMessage","setNewMessage","loading","setLoading","chatLoading","setChatLoading","error","setError","isTyping","setIsTyping","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","fetchChats","fetchChat","console","log","response","get","data","id","chat","createNewChat","post","title","newChat","window","history","pushState","sendMessage","e","preventDefault","trim","messageContent","timeoutPromise","Promise","_","reject","setTimeout","Error","race","content","userMessage","assistantMessage","updatedChatTitle","prev","updatedChat","updated_at","Date","toISOString","map","message","formatTime","dateString","toLocaleTimeString","hour","minute","sx","height","display","gap","children","width","p","overflowY","alignItems","justifyContent","mb","variant","onClick","color","cursor","borderRadius","backgroundColor","overflow","arrow","textOverflow","whiteSpace","flex","flexDirection","severity","m","textAlign","fontSize","mt","startIcon","borderBottom","borderColor","role","mx","bgcolor","maxWidth","components","_ref","h1","_ref2","fontWeight","h2","_ref3","h3","_ref4","ul","_ref5","component","pl","ol","_ref6","li","_ref7","strong","_ref8","em","_ref9","fontStyle","code","_ref0","padding","fontFamily","pre","_ref1","margin","blockquote","_ref10","borderLeft","borderLeftColor","opacity","created_at","size","ref","onSubmit","borderTop","fullWidth","multiline","maxRows","placeholder","value","onChange","target","disabled","onKeyPress","key","shiftKey","type","minWidth","px"],"sources":["/home/thorsten/Development/willi_mako/client/src/pages/Chat.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';\nimport {\n  Box,\n  Paper,\n  TextField,\n  Button,\n  Typography,\n  List,\n  ListItem,\n  Avatar,\n  Divider,\n  IconButton,\n  CircularProgress,\n  Alert,\n  Tooltip,\n} from '@mui/material';\nimport {\n  Send as SendIcon,\n  Person as PersonIcon,\n  SmartToy as BotIcon,\n  Add as AddIcon,\n} from '@mui/icons-material';\nimport { useSnackbar } from '../contexts/SnackbarContext';\nimport axios from 'axios';\n\ninterface Message {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  created_at: string;\n}\n\ninterface ChatSession {\n  id: string;\n  title: string;\n  created_at: string;\n  updated_at: string;\n}\n\nconst Chat: React.FC = () => {\n  const { chatId } = useParams<{ chatId: string }>();\n  const { showSnackbar } = useSnackbar();\n  \n  const [chats, setChats] = useState<ChatSession[]>([]);\n  const [currentChat, setCurrentChat] = useState<ChatSession | null>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [chatLoading, setChatLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isTyping, setIsTyping] = useState(false);\n  \n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    fetchChats();\n  }, []);\n\n  useEffect(() => {\n    if (chatId) {\n      fetchChat(chatId);\n    }\n  }, [chatId]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const fetchChats = async () => {\n    try {\n      console.log('Fetching chats...');\n      const response = await axios.get('/chat/chats');\n      console.log('Chats fetched:', response.data.data);\n      setChats(response.data.data);\n    } catch (error) {\n      console.error('Error fetching chats:', error);\n      setError('Fehler beim Laden der Chats');\n    }\n  };\n\n  const fetchChat = async (id: string) => {\n    try {\n      console.log('Fetching chat:', id);\n      setChatLoading(true);\n      // Reset loading state for message sending when switching chats\n      setLoading(false);\n      setIsTyping(false);\n      const response = await axios.get(`/chat/chats/${id}`);\n      console.log('Chat fetched:', response.data.data);\n      setCurrentChat(response.data.data.chat);\n      setMessages(response.data.data.messages || []);\n      setError(null);\n    } catch (error) {\n      console.error('Error fetching chat:', error);\n      setError('Fehler beim Laden des Chats');\n    } finally {\n      console.log('Setting chatLoading to false');\n      setChatLoading(false);\n    }\n  };\n\n  const createNewChat = async () => {\n    try {\n      console.log('Creating new chat...');\n      const response = await axios.post('/chat/chats', { \n        title: 'Neuer Chat' \n      });\n      console.log('New chat created:', response.data.data);\n      const newChat = response.data.data;\n      setChats([newChat, ...chats]);\n      setCurrentChat(newChat);\n      setMessages([]);\n      // Reset loading states when creating new chat\n      setLoading(false);\n      setIsTyping(false);\n      window.history.pushState({}, '', `/chat/${newChat.id}`);\n    } catch (error) {\n      console.error('Error creating new chat:', error);\n      showSnackbar('Fehler beim Erstellen des Chats', 'error');\n    }\n  };\n\n  const sendMessage = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!newMessage.trim() || !currentChat || loading) {\n      return;\n    }\n\n    const messageContent = newMessage.trim();\n    setNewMessage('');\n    setLoading(true);\n    setIsTyping(true);\n\n    console.log('Sending message:', messageContent);\n\n    // Timeout-Promise für 30 Sekunden\n    const timeoutPromise = new Promise((_, reject) => {\n      setTimeout(() => reject(new Error('Request timeout')), 30000);\n    });\n\n    try {\n      const response = await Promise.race([\n        axios.post(`/chat/chats/${currentChat.id}/messages`, {\n          content: messageContent\n        }),\n        timeoutPromise\n      ]) as any;\n\n      console.log('API Response:', response);\n\n      // Validate response structure\n      if (!response.data || !response.data.data) {\n        throw new Error('Invalid response format: missing data');\n      }\n\n      const { userMessage, assistantMessage, updatedChatTitle } = response.data.data;\n      \n      // Validate required fields\n      if (!userMessage || !assistantMessage) {\n        throw new Error('Invalid response format: missing userMessage or assistantMessage');\n      }\n\n      console.log('User message:', userMessage);\n      console.log('Assistant message:', assistantMessage);\n      \n      setMessages(prev => [...prev, userMessage, assistantMessage]);\n      \n      // Update chat in the list and current chat if title was updated\n      if (updatedChatTitle) {\n        console.log('Updating chat title:', updatedChatTitle);\n        const updatedChat = { ...currentChat, title: updatedChatTitle, updated_at: new Date().toISOString() };\n        setCurrentChat(updatedChat);\n        setChats(prev => prev.map(chat => \n          chat.id === currentChat.id \n            ? updatedChat\n            : chat\n        ));\n      } else {\n        // Update chat timestamp\n        setChats(prev => prev.map(chat => \n          chat.id === currentChat.id \n            ? { ...chat, updated_at: new Date().toISOString() }\n            : chat\n        ));\n      }\n\n      console.log('Message sent successfully');\n\n    } catch (error: any) {\n      console.error('Error sending message:', error);\n      \n      // Restore the message input if there was an error\n      setNewMessage(messageContent);\n      \n      if (error?.message === 'Request timeout') {\n        showSnackbar('Anfrage ist abgelaufen. Bitte versuchen Sie es erneut.', 'error');\n      } else {\n        showSnackbar('Fehler beim Senden der Nachricht', 'error');\n      }\n    } finally {\n      console.log('Setting loading to false');\n      setLoading(false);\n      setIsTyping(false);\n    }\n  };\n\n  const formatTime = (dateString: string) => {\n    return new Date(dateString).toLocaleTimeString('de-DE', {\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  return (\n    <Box sx={{ height: 'calc(100vh - 100px)', display: 'flex', gap: 2 }}>\n      {/* Chat List Sidebar */}\n      <Paper sx={{ width: 300, p: 2, overflowY: 'auto' }}>\n        <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', mb: 2 }}>\n          <Typography variant=\"h6\">Chats</Typography>\n          <IconButton onClick={createNewChat} color=\"primary\">\n            <AddIcon />\n          </IconButton>\n        </Box>\n        <Divider sx={{ mb: 2 }} />\n        <List>\n          {chats.map((chat) => (\n            <ListItem\n              key={chat.id}\n              sx={{\n                cursor: 'pointer',\n                borderRadius: 1,\n                mb: 1,\n                backgroundColor: currentChat?.id === chat.id ? 'primary.light' : 'transparent',\n                '&:hover': { backgroundColor: 'action.hover' },\n              }}\n              onClick={() => {\n                setCurrentChat(chat);\n                // Reset loading states when switching chats\n                setLoading(false);\n                setIsTyping(false);\n                fetchChat(chat.id);\n                window.history.pushState({}, '', `/chat/${chat.id}`);\n              }}\n            >\n              <Box sx={{ width: '100%', overflow: 'hidden' }}>\n                <Tooltip title={chat.title} arrow>\n                  <Typography \n                    variant=\"subtitle2\" \n                    sx={{\n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis',\n                      whiteSpace: 'nowrap',\n                      width: '100%',\n                      display: 'block'\n                    }}\n                  >\n                    {chat.title}\n                  </Typography>\n                </Tooltip>\n                <Typography variant=\"caption\" color=\"text.secondary\">\n                  {formatTime(chat.updated_at)}\n                </Typography>\n              </Box>\n            </ListItem>\n          ))}\n        </List>\n      </Paper>\n\n      {/* Chat Area */}\n      <Paper sx={{ flex: 1, display: 'flex', flexDirection: 'column' }}>\n        {error && (\n          <Alert severity=\"error\" sx={{ m: 2 }}>\n            {error}\n          </Alert>\n        )}\n        \n        {!currentChat ? (\n          <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center', flex: 1 }}>\n            <Box sx={{ textAlign: 'center' }}>\n              <BotIcon sx={{ fontSize: 80, color: 'text.secondary', mb: 2 }} />\n              <Typography variant=\"h6\" color=\"text.secondary\">\n                Wählen Sie einen Chat oder starten Sie ein neues Gespräch mit Mako Willi\n              </Typography>\n              <Button\n                variant=\"contained\"\n                onClick={createNewChat}\n                sx={{ mt: 2 }}\n                startIcon={<AddIcon />}\n              >\n                Neuen Chat mit Mako Willi starten\n              </Button>\n            </Box>\n          </Box>\n        ) : (\n          <>\n            {/* Chat Header */}\n            <Box sx={{ p: 2, borderBottom: 1, borderColor: 'divider' }}>\n              <Typography variant=\"h6\">{currentChat.title}</Typography>\n            </Box>\n\n            {/* Messages */}\n            <Box sx={{ flex: 1, overflowY: 'auto', p: 2 }}>\n              {chatLoading ? (\n                <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\n                  <CircularProgress />\n                </Box>\n              ) : (\n                <List>\n                  {messages.map((message) => (\n                    <ListItem\n                      key={message.id}\n                      sx={{\n                        alignItems: 'flex-start',\n                        mb: 2,\n                        flexDirection: message.role === 'user' ? 'row-reverse' : 'row',\n                      }}\n                    >\n                      <Avatar\n                        sx={{\n                          mx: 1,\n                          bgcolor: message.role === 'user' ? 'primary.main' : 'secondary.main',\n                        }}\n                      >\n                        {message.role === 'user' ? <PersonIcon /> : <BotIcon />}\n                      </Avatar>\n                      <Paper\n                        sx={{\n                          p: 2,\n                          maxWidth: '70%',\n                          bgcolor: message.role === 'user' ? 'primary.light' : 'grey.100',\n                          color: message.role === 'user' ? 'white' : 'text.primary',\n                        }}\n                      >\n                        {message.role === 'user' ? (\n                          <Typography variant=\"body1\" sx={{ whiteSpace: 'pre-wrap' }}>\n                            {message.content}\n                          </Typography>\n                        ) : (\n                          <ReactMarkdown\n                            components={{\n                              p: ({ children }) => (\n                                <Typography variant=\"body1\" sx={{ mb: 1 }}>\n                                  {children}\n                                </Typography>\n                              ),\n                              h1: ({ children }) => (\n                                <Typography variant=\"h4\" sx={{ mb: 1, fontWeight: 'bold' }}>\n                                  {children}\n                                </Typography>\n                              ),\n                              h2: ({ children }) => (\n                                <Typography variant=\"h5\" sx={{ mb: 1, fontWeight: 'bold' }}>\n                                  {children}\n                                </Typography>\n                              ),\n                              h3: ({ children }) => (\n                                <Typography variant=\"h6\" sx={{ mb: 1, fontWeight: 'bold' }}>\n                                  {children}\n                                </Typography>\n                              ),\n                              ul: ({ children }) => (\n                                <Box component=\"ul\" sx={{ mb: 1, pl: 2 }}>\n                                  {children}\n                                </Box>\n                              ),\n                              ol: ({ children }) => (\n                                <Box component=\"ol\" sx={{ mb: 1, pl: 2 }}>\n                                  {children}\n                                </Box>\n                              ),\n                              li: ({ children }) => (\n                                <Typography component=\"li\" variant=\"body1\" sx={{ mb: 0.5 }}>\n                                  {children}\n                                </Typography>\n                              ),\n                              strong: ({ children }) => (\n                                <Typography component=\"strong\" sx={{ fontWeight: 'bold' }}>\n                                  {children}\n                                </Typography>\n                              ),\n                              em: ({ children }) => (\n                                <Typography component=\"em\" sx={{ fontStyle: 'italic' }}>\n                                  {children}\n                                </Typography>\n                              ),\n                              code: ({ children }) => (\n                                <Typography\n                                  component=\"code\"\n                                  sx={{\n                                    backgroundColor: 'rgba(0,0,0,0.1)',\n                                    padding: '2px 4px',\n                                    borderRadius: '4px',\n                                    fontFamily: 'monospace',\n                                    fontSize: '0.9em',\n                                  }}\n                                >\n                                  {children}\n                                </Typography>\n                              ),\n                              pre: ({ children }) => (\n                                <Paper\n                                  sx={{\n                                    p: 1,\n                                    backgroundColor: 'rgba(0,0,0,0.1)',\n                                    overflow: 'auto',\n                                    mb: 1,\n                                  }}\n                                >\n                                  <Typography\n                                    component=\"pre\"\n                                    sx={{\n                                      fontFamily: 'monospace',\n                                      fontSize: '0.9em',\n                                      whiteSpace: 'pre-wrap',\n                                      margin: 0,\n                                    }}\n                                  >\n                                    {children}\n                                  </Typography>\n                                </Paper>\n                              ),\n                              blockquote: ({ children }) => (\n                                <Paper\n                                  sx={{\n                                    p: 1,\n                                    borderLeft: '4px solid',\n                                    borderLeftColor: 'primary.main',\n                                    backgroundColor: 'rgba(0,0,0,0.05)',\n                                    mb: 1,\n                                  }}\n                                >\n                                  {children}\n                                </Paper>\n                              ),\n                            }}\n                          >\n                            {message.content}\n                          </ReactMarkdown>\n                        )}\n                        <Typography\n                          variant=\"caption\"\n                          sx={{\n                            display: 'block',\n                            mt: 1,\n                            opacity: 0.7,\n                          }}\n                        >\n                          {formatTime(message.created_at)}\n                        </Typography>\n                      </Paper>\n                    </ListItem>\n                  ))}\n                  \n                  {/* Typing indicator */}\n                  {isTyping && (\n                    <ListItem\n                      sx={{\n                        alignItems: 'flex-start',\n                        mb: 2,\n                        flexDirection: 'row',\n                      }}\n                    >\n                      <Avatar\n                        sx={{\n                          mx: 1,\n                          bgcolor: 'secondary.main',\n                        }}\n                      >\n                        <BotIcon />\n                      </Avatar>\n                      <Paper\n                        sx={{\n                          p: 2,\n                          maxWidth: '70%',\n                          bgcolor: 'grey.100',\n                          color: 'text.primary',\n                        }}\n                      >\n                        <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                          <CircularProgress size={16} />\n                          <Typography variant=\"body2\" sx={{ fontStyle: 'italic' }}>\n                            Mako Willi tippt...\n                          </Typography>\n                        </Box>\n                      </Paper>\n                    </ListItem>\n                  )}\n                  \n                  <div ref={messagesEndRef} />\n                </List>\n              )}\n            </Box>\n\n            {/* Message Input */}\n            <Box\n              component=\"form\"\n              onSubmit={sendMessage}\n              sx={{ p: 2, borderTop: 1, borderColor: 'divider' }}\n            >\n              <Box sx={{ display: 'flex', gap: 1 }}>\n                <TextField\n                  fullWidth\n                  multiline\n                  maxRows={4}\n                  placeholder=\"Fragen Sie Mako Willi etwas über die Energiewirtschaft...\"\n                  value={newMessage}\n                  onChange={(e) => setNewMessage(e.target.value)}\n                  disabled={loading}\n                  onKeyPress={(e) => {\n                    if (e.key === 'Enter' && !e.shiftKey) {\n                      e.preventDefault();\n                      sendMessage(e);\n                    }\n                  }}\n                />\n                <Button\n                  type=\"submit\"\n                  variant=\"contained\"\n                  disabled={loading || !newMessage.trim()}\n                  sx={{ minWidth: 'auto', px: 2 }}\n                >\n                  {loading ? <CircularProgress size={24} /> : <SendIcon />}\n                </Button>\n              </Box>\n            </Box>\n          </>\n        )}\n      </Paper>\n    </Box>\n  );\n};\n\nexport default Chat;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}